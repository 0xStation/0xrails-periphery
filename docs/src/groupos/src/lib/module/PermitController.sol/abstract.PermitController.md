# PermitController
[Git Source](https://github.com/0xStation/groupos/blob/a8023d340c65e0d686ded288134361dc4f500ad5/src/lib/module/PermitController.sol)

**Inherits:**
[NonceBitMap](/src/lib/NonceBitMap.sol/abstract.NonceBitMap.md)

*This contract provides a framework for permit-based function authentication using EIP-712 signatures.
It allows callers to execute functions on behalf of authorized signers by presenting a valid permit
containing an EIP-712 signature. This contract also includes reentrancy protection*


## State Variables
### GRANT_TYPE_HASH

```solidity
bytes32 private constant GRANT_TYPE_HASH =
    keccak256("Permit(address sender,uint48 expiration,uint256 nonce,bytes data)");
```


### DOMAIN_TYPE_HASH

```solidity
bytes32 private constant DOMAIN_TYPE_HASH =
    keccak256("EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)");
```


### NAME_HASH

```solidity
bytes32 private constant NAME_HASH = keccak256("GroupOS");
```


### VERSION_HASH

```solidity
bytes32 private constant VERSION_HASH = keccak256("0.0.1");
```


### INITIAL_DOMAIN_SEPARATOR

```solidity
bytes32 internal immutable INITIAL_DOMAIN_SEPARATOR;
```


### INITIAL_CHAIN_ID

```solidity
uint256 internal immutable INITIAL_CHAIN_ID;
```


### UNVERIFIED

```solidity
address private constant UNVERIFIED = address(1);
```


### UNLOCKED

```solidity
uint256 private constant UNLOCKED = 1;
```


### LOCKED

```solidity
uint256 private constant LOCKED = 2;
```


### verifiedSigner

```solidity
address private verifiedSigner = UNVERIFIED;
```


### lock

```solidity
uint256 private lock = UNLOCKED;
```


## Functions
### constructor


```solidity
constructor();
```

### usePermits

Authenticate module functions for collections with permits and reentrancy protection


```solidity
modifier usePermits(bytes memory context);
```

### callWithPermit

Authenticate permit and make a self-call

*Can only be used on functions that are protected with onlyPermited*


```solidity
function callWithPermit(Permit calldata permit) external payable;
```

### signerCanPermit

Override to customize which signers are allowed


```solidity
function signerCanPermit(address, bytes memory) public view virtual returns (bool);
```

### requirePermits

Override to support disabling permits


```solidity
function requirePermits(bytes memory) public view virtual returns (bool);
```

### _verifySigner

Verify the signer, signature, and data align and revert otherwise


```solidity
function _verifySigner(Permit memory permit) private view;
```

### _domainSeparator


```solidity
function _domainSeparator() private view returns (bytes32);
```

## Errors
### Reentrancy

```solidity
error Reentrancy();
```

### PermitSignerInvalid

```solidity
error PermitSignerInvalid(address signer);
```

### PermitExpired

```solidity
error PermitExpired(uint48 expiration, uint48 current);
```

### PermitSenderMismatch

```solidity
error PermitSenderMismatch(address expected, address sender);
```

### PermitInvalidSignature

```solidity
error PermitInvalidSignature(address signer, bytes32 permitHash, bytes signature);
```

### PermitCallFailed

```solidity
error PermitCallFailed(bytes data);
```

### PermitCallUnprotected

```solidity
error PermitCallUnprotected();
```

## Structs
### Permit
*Struct of Permit data to be hashed and signed for meta-transactions.*


```solidity
struct Permit {
    address signer;
    address sender;
    uint48 expiration;
    uint256 nonce;
    bytes data;
    bytes signature;
}
```

**Properties**

|Name|Type|Description|
|----|----|-----------|
|`signer`|`address`|The authorized signer's address.|
|`sender`|`address`|The address of the sender.|
|`expiration`|`uint48`|The expiration timestamp of the permit.|
|`nonce`|`uint256`|A unique nonce to prevent replay attacks.|
|`data`|`bytes`|The data to be executed as part of the function call.|
|`signature`|`bytes`|The EIP-712 signature generated by the authorized signer.|

